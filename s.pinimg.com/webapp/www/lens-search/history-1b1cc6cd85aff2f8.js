(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[56690],{362357:function(e,t,n){(window.__PWS_LOADED_HANDLERS__=window.__PWS_LOADED_HANDLERS__||{})["www/lens-search/history"]=function(){return n(687462).Z}},688550:function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return o.apply(this,arguments)}function o(){var e;return e=regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.abrupt("return",new File([r],"image.png"));case 7:case"end":return e.stop()}},e)}),(o=function(){var t=this,n=arguments;return new Promise(function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)})}).apply(this,arguments)}n.d(t,{Z:function(){return i}})},745339:function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e,t){return o.apply(this,arguments)}function o(){var e;return e=regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){var r=new FileReader;r.onload=function(){var i=new Image;i.src=r.result,i.onload=function(){var r=i.height,o=i.width;o>474&&(r*=474/o,o=474),n({src:i.src,height:r,width:o});var a=document.createElement("canvas");a.width=o,a.height=r,a.getContext("2d").drawImage(i,0,0,o,r),a.toBlob(function(n){e(new File([n],t.name,{type:"image/jpeg"}))},"image/jpeg",.9)}},r.readAsDataURL(t)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}),(o=function(){var t=this,n=arguments;return new Promise(function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)})}).apply(this,arguments)}n.d(t,{Z:function(){return i}})},687462:function(e,t,n){"use strict";n.d(t,{Z:function(){return D}});var r=n(672652),i=n(328038),o=n(684404),a=n(105737),s=n(107366),u=n(213377),l=n(140017),c=n(995917),h=n(477458),f=n(688550),d=n(22570),g=n(785964),m=n(99602),_=n(454514),p=n(13848),v=n(691010),y=n(272232),x=n(819267);function w(e){var t=e.onDelete,n=e.onSave,r=e.height,i=e.width,a=(0,l.ZP)(),s=(0,p.F9)(),u=function(){t(),s.showOneToast(function(e){var t=e.hideToast;return(0,x.jsx)(_.ZP,{duration:v.A,onHide:t,text:(0,x.jsx)(o.xv,{children:a._('Successfully deleted', 'lens.history.image.deleted', 'Image from lens history has been deleted')})})})};return(0,x.jsxs)(o.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0,0,0,0.4)"}},height:r,left:!0,position:"absolute",rounding:4,top:!0,width:i,children:[(0,x.jsx)(o.xu,{margin:3,right:!0,top:!0,children:(0,x.jsx)(y.Z,{onClick:function(e){e.stopPropagation(),n()},pinKey:null})}),(0,x.jsx)(o.xu,{bottom:!0,margin:3,position:"absolute",right:!0,children:(0,x.jsx)(o.iP,{onTap:function(e){e.event.stopPropagation(),u()},rounding:"circle",children:(0,x.jsx)(o.xu,{alignItems:"center",color:"light",display:"flex",justifyContent:"center",minHeight:32,minWidth:32,padding:3,rounding:"circle",children:(0,x.jsx)(o.JO,{accessibilityLabel:a._('Delete', 'lens.history.image.delete', 'Clikcking on this delete the image from the lens history'),color:"default",icon:"trash-can",size:16})})})})]})}var j=n(745339);function b(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,i)}function A(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){b(o,r,i,a,s,"next",e)}function s(e){b(o,r,i,a,s,"throw",e)}a(void 0)})}}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var D=function(){var e,t,n=(0,l.ZP)(),_=(0,i.k6)(),p=(0,g.t)(),v=p.setHeroImageUrl,y=p.setImage,b=p.image,S=p.setImageData,D=P((0,r.useState)(),2),E=D[0],L=D[1],R=P((0,r.useState)(!1),2),I=R[0],Z=R[1],k=P((0,r.useState)(""),2),z=k[0],O=k[1],H=P((0,r.useState)(),2),C=H[0],M=H[1],U=(0,c.Z)({name:"ApiResource",options:{url:"/v3/visual_search/lens/history/",data:{fields:"id,image_urls,image_sizes"}}}),F=U.data,T=void 0===F?[]:F,W=U.fetchMore;(0,r.useEffect)(function(){T&&L(T)},[T]);var N=(e=A(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.Z)({url:"/v3/visual_search/lens/history/",data:{lens_history_ids:[t]},method:"DELETE"});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}},e,null,[[0,5]])})),function(t){return e.apply(this,arguments)}),B=function(e){L(null==E?void 0:E.filter(function(t){return(null==t?void 0:t.id)!==e||(N(e),!1)}))},K=(0,r.useCallback)(A(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=5;break}return e.next=3,(0,j.Z)(C,S);case 3:y(e.sent);case 5:case"end":return e.stop()}},e)})),[C,S,y]);(0,r.useEffect)(function(){(0,a.ZP)(b,C)||_.push("/lens-search/")},[b,C,_]),(0,r.useEffect)(function(){C&&K()},[_,K,C]);var q=(t=A(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.Z)(t);case 2:M(e.sent),v(t);case 5:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)});return!E||E&&0===E.length?null:(0,x.jsxs)(r.Fragment,{children:[(0,x.jsx)(m.Z,{title:n._('History', 'lens.history.page.header', 'Heading for the Lens History Page')}),(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginTop:m.M}},children:(0,x.jsx)(o.Rk,{columnWidth:u.yF,gutterWidth:24,items:E,loadItems:W,renderItem:function(e){var t=e.data,r=t.id,i=function(e){for(var t=e.imageUrls,n=e.imageSizes,r=0,i=["736x","1200x","474x474","236x236"];r<i.length;r++){var o=i[r];if(t[o]&&n[o]){var a=Math.round(236/(n[o].width/n[o].height));return{url:t[o],height:a,width:u.yF}}}return null}({imageUrls:t.image_urls,imageSizes:t.image_sizes});if(i){var a=i.url,s=i.height,l=i.width;return(0,x.jsx)(h.q,{children:function(e){var t=e.hovered,i=e.onMouseEnter,u=e.onMouseLeave;return(0,x.jsxs)(o.xu,{onMouseEnter:i,onMouseLeave:u,position:"relative",children:[(0,x.jsx)(o.zd,{height:s,rounding:4,wash:!0,width:l,children:(0,x.jsx)(o.xu,{height:"100%",width:"100%",children:(0,x.jsx)(o.Ee,{alt:n._('Lens history image', 'lens.history.image.alt', 'Image that was uploaded by the user to Lens History'),fit:"cover",naturalHeight:1,naturalWidth:1,src:a})})}),t&&(0,x.jsx)(o.iP,{onTap:function(){return q(a)},children:(0,x.jsx)(w,{height:s,onDelete:function(){return B(r)},onSave:function(){O(a),Z(!0)},width:l})})]})}},r)}return null},scrollContainer:function(){return window}})}),I&&(0,x.jsx)(d.Z,{imageUrl:z,onDismissModal:function(){return Z(!1)}})]})}}},function(e){e.O(0,[97270,84404,28038,24797,55169,64283,2909,27672,7012,64212,23813,90280,86546,10087],function(){return e(e.s=362357)}),e.O()}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/www/lens-search/history-1b1cc6cd85aff2f8.js.map