"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[65923],{584452:function(e,t,r){var a=r(672652),n=r(293041),o=r(684404),i=r(587703),l=r(406893),s=r(340523),c=r(5859),u=r(149722),d=r(813779),p=r(115557),f=r(239821),y=r(734950),v=r(819267),m=["clientTrackingParams","component","durationNs","element","objectId","pairId","viewData","view","viewParameter"];function b(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,T(a.key),a)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach(function(t){k(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function k(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==E(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var D=function(e){return"string"==typeof e?e:Array.isArray(e)?e[0].src?[w(w({},e[0]),{},{src:e[0].src})]:e:e},O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(s,e);var t,r,a,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=g(s);if(t){var a=g(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return P(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return k(P(e=i.call.apply(i,[this].concat(r))),"state",{canPlayVideo:!1,isManifestParsed:!1,playbackState:p.Cy.DEFAULT,videoStartTime:e.props.seekTime||0}),k(P(e),"errorRetryCount",1),k(P(e),"firstFragBuffered",!1),k(P(e),"hasPlaybackStarted",!1),k(P(e),"hasVideoSessionStarted",!1),k(P(e),"hasVideoSessionEnded",!1),k(P(e),"hls",null),k(P(e),"fragStartupTime",{}),k(P(e),"lastLevelSwitchKbps",null),k(P(e),"lastStallTime",null),k(P(e),"lastPauseTime",null),k(P(e),"logSessionStartOnNextPlay",!1),k(P(e),"playerId",""),k(P(e),"videoSessionId",""),k(P(e),"videoVisibleTime",null),k(P(e),"playbackPerformance",{canPlayTime:null,detailedErrors:"",downloadedKiloBytes:0,errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:"string"==typeof e.props.src?e.props.src:e.props.src[0].src,totalStallDurationMs:0,totalPauseDurationMs:0,videoCreatedTime:null,webBrowser:e.props.webBrowser,webBrowserVersion:e.props.webBrowserVersion}),k(P(e),"initializeHls",function(){e.destroyHls();var t=e.props,r=t.src,a=t.hlsConfig,o=new n.ZP(a),i=D(r);o.loadSource(i),e.videoPlayerRef&&o.attachMedia(e.videoPlayerRef.video),o.on(n.ZP.Events.FRAG_BUFFERED,e.handleHlsFragBuffered),o.on(n.ZP.Events.FRAG_CHANGED,e.handleHlsFragChanged),o.on(n.ZP.Events.FRAG_LOADING,e.handleHlsFragLoading),o.on(n.ZP.Events.FRAG_LOADED,e.handleHlsFragLoaded),o.on(n.ZP.Events.MANIFEST_PARSED,function(){e.setState({isManifestParsed:!0})}),o.on(n.ZP.Events.LEVEL_SWITCHED,e.handleHlsLevelSwitched),o.on(n.ZP.Events.ERROR,e.handleHlsError),e.hls=o}),k(P(e),"destroyHls",function(){var t=P(e).hls;t&&t.destroy()}),k(P(e),"addSegment",function(t){var r=e.playbackPerformance.segments,a=r&&r[r.length-1];if(e.hls&&r.length&&a&&a.uri!==t.url){e.updateWatchDurationForCurrentSegment();var n=e.videoPlayerRef&&e.videoPlayerRef.video,o=e.hls&&e.hls.levels||{},i="number"==typeof t.level?o[t.level]:{},l=e.fragStartupTime[t.url],s=-1;l&&l.startLoadTime&&l.endLoadTime&&(s=l.endLoadTime-l.startLoadTime);var c={indicatedKbps:i.bitrate/p.bR,duration:t.duration,level:t.level,lastStartPlayTime:e.getCurrentVideoTime(),numServerAddressChange:-1,observedKbps:e.hls&&e.hls.bandwidthEstimate/p.bR||-1,playbackStartDate:Date.now(),serverAddress:"",sn:t.sn,sourceWidth:i.width,sourceHeight:i.height,startupTimeMs:s,switchBitrateKbps:e.lastLevelSwitchKbps||-1,uri:t.url,viewportWidth:n&&n.clientWidth||-1,viewportHeight:n&&n.clientHeight||-1,watchedDurationMs:0};r.push(c)}}),k(P(e),"initializeSegments",function(t){var r=e.props.contextLogData,a=(void 0===r?{}:r).is_closeup_video,n=e.playbackPerformance.segments;if(!n.length){if(!e.hls||!e.videoPlayerRef||!e.videoPlayerRef.video||!t){(0,d.tE)("initializeSegmentsFailed",!0,void 0!==a&&a);return}if(!n.length&&"number"==typeof t.level){var o=e.videoPlayerRef&&e.videoPlayerRef.video,i=e.hls.levels,l="number"==typeof t.level?i[t.level]:{},s=e.fragStartupTime[t.url],c=-1;s&&s.startLoadTime&&s.endLoadTime&&(c=s.endLoadTime-s.startLoadTime),e.lastLevelSwitchKbps=e.hls.bandwidthEstimate/p.bR;var u={indicatedKbps:l.bitrate/p.bR,duration:t.duration,level:t.level,lastStartPlayTime:null,numServerAddressChange:-1,observedKbps:e.hls.bandwidthEstimate/p.bR||-1,playbackStartDate:null,serverAddress:"",sn:t.sn,sourceWidth:l.width,sourceHeight:l.height,startupTimeMs:c,switchBitrateKbps:e.lastLevelSwitchKbps||-1,uri:t.url,viewportWidth:o.clientWidth,viewportHeight:o.clientHeight,watchedDurationMs:0};n.push(u)}}}),k(P(e),"getCurrentVideoTime",function(){return e.videoPlayerRef&&e.videoPlayerRef.video?e.videoPlayerRef.video.currentTime*p.gJ:null}),k(P(e),"handleCanPlayVideo",function(t){var r=e.props,a=r.contextLogData,n=r.onReady,o=r.playing,i=(void 0===a?{}:a).is_closeup_video,l=void 0!==i&&i,s=e.state.canPlayVideo;(0,d.tE)("handleCanPlayVideo",!0,l,{firstCanPlayEvent:!s,playing:o}),e.playbackPerformance.hasFatalError=!1,s||(e.playbackPerformance.canPlayTime=new Date),e.setState({canPlayVideo:!0}),n&&n(t)}),k(P(e),"handleEnded",function(t){var r=e.props,a=r.loop,n=r.onEnded,o=e.playbackPerformance.segments,i=o&&o[o.length-1];a&&e.videoPlayerRef&&e.videoPlayerRef.video?(e.updateWatchDurationForCurrentSegment(),i&&(i.lastStartPlayTime=0),e.fragStartupTime={}):a||e.logPlaybackPerformance(p.$f,{initiator:"videoEnded",loop:a}),e.setState({playbackState:p.Cy.ENDED}),n&&n(t)}),k(P(e),"handleHlsError",function(t,r){var a=e.props.contextLogData,o=(void 0===a?{}:a).is_closeup_video;if(e.playbackPerformance.detailedErrors+="".concat(e.playbackPerformance.detailedErrors.length>0?", ":"").concat(r.details),r.fatal){e.playbackPerformance.hasFatalError=!0,e.playbackPerformance.errorName=r.type,e.playbackPerformance.errorReason=r.details,e.playbackPerformance.errorCode=r.response&&r.response.code?r.response.code:0;var i={errorName:r.type,errorReason:r.details,errorRetryCount:e.errorRetryCount,errorMessage:(null===(s=r.err)||void 0===s?void 0:null===(c=s.message)||void 0===c?void 0:c.slice(0,50))||"unknown",errorResponse:(null===(u=r.response)||void 0===u?void 0:null===(f=u.text)||void 0===f?void 0:f.slice(0,50))||"unknown",playbackState:e.state.playbackState};if((0,d.tE)("fatalError",!0,void 0!==o&&o,i),e.errorRetryCount>0)switch(e.errorRetryCount-=1,r.type){case n.ZP.ErrorTypes.NETWORK_ERROR:if(r.details===n.ZP.ErrorDetails.MANIFEST_LOAD_ERROR||r.details===n.ZP.ErrorDetails.MANIFEST_LOAD_TIMEOUT||r.details===n.ZP.ErrorDetails.MANIFEST_LOAD_PARSING_ERROR){var l,s,c,u,f,y,v,m=D(e.props.src);null===(v=e.hls)||void 0===v||v.loadSource(m)}else null===(y=e.hls)||void 0===y||y.startLoad();break;case n.ZP.ErrorTypes.MEDIA_ERROR:null===(l=e.hls)||void 0===l||l.recoverMediaError()}}e.updateWatchDurationForCurrentSegment(),e.setState({playbackState:p.Cy.FAILED})}),k(P(e),"handleHlsFragBuffered",function(t,r){e.firstFragBuffered||(e.initializeSegments(r.frag),e.firstFragBuffered=!0)}),k(P(e),"handleHlsFragChanged",function(t,r){e.addSegment(r.frag)}),k(P(e),"handleHlsFragLoading",function(t,r){var a,n=null===(a=r.frag)||void 0===a?void 0:a.url;n&&!e.fragStartupTime[n]&&(e.fragStartupTime[n]={startLoadTime:new Date})}),k(P(e),"handleHlsFragLoaded",function(t,r){r.frag&&r.frag.loaded&&(e.playbackPerformance.downloadedKiloBytes+=r.frag.loaded/p.Fm);var a,n=null===(a=r.frag)||void 0===a?void 0:a.url;n&&e.fragStartupTime[n]&&e.fragStartupTime[n].startLoadTime&&(e.fragStartupTime[n].endLoadTime=new Date)}),k(P(e),"handleHlsLevelSwitched",function(){e.hls&&e.hls.bandwidthEstimate&&(e.lastLevelSwitchKbps=e.hls.bandwidthEstimate/p.bR)}),k(P(e),"handleLoadedMetadata",function(){e.setState({playbackState:p.Cy.LOADED_METADATA})}),k(P(e),"handleLoadStart",function(){e.playbackPerformance.loadStartTime=new Date,e.setState({playbackState:p.Cy.LOAD_START})}),k(P(e),"handleLoadedData",function(){e.setState({playbackState:p.Cy.LOADED_DATA})}),k(P(e),"handlePlaying",function(t){e.playbackPerformance.hasFatalError=!1,e.setPlaybackStartTime(),e.setLastSegmentStartPlayTime(),e.setLastSegmentPlaybackStartDate(),e.updateStallDuration(),e.updatePauseDuration(),e.setState({playbackState:p.Cy.PLAYING}),e.props.clearSeekTime&&e.props.clearSeekTime(),e.props.onPlaying&&e.props.onPlaying(t)}),k(P(e),"handleUserPause",function(t){var r=e.props.onControlsPause;e.lastPauseTime=new Date,r&&r(t)}),k(P(e),"handleVideoPause",function(){e.state.playbackState===p.Cy.STALLING||e.state.playbackState===p.Cy.SEEKING||(e.updateWatchDurationForCurrentSegment(),e.lastPauseTime||e.updateStallDuration()),e.setState({playbackState:p.Cy.PAUSED})}),k(P(e),"handleSeeking",function(){e.playbackPerformance.numberOfSeeks+=1;var t=e.playbackPerformance.segments,r=t&&t[t.length-1];r&&(r.lastStartPlayTime=null),e.state.playbackState!==p.Cy.ENDED&&e.setState({playbackState:p.Cy.SEEKING})}),k(P(e),"handleStalled",function(){null===e.lastStallTime&&e.state.playbackState!==p.Cy.ENDED&&(e.lastStallTime=new Date,e.playbackPerformance.numberOfStalls+=1),e.setState({playbackState:p.Cy.STALLING})}),k(P(e),"handleTimeUpdate",function(t){var r=e.props.onTimeChange;r&&r(t),e.state.playbackState===p.Cy.PLAYING&&(e.updateWatchDurationForCurrentSegment(),e.setLastSegmentStartPlayTime())}),k(P(e),"resetPlaybackMetrics",function(){e.hasPlaybackStarted=!1,e.hasVideoSessionStarted=!1,e.hasVideoSessionEnded=!0,e.lastLevelSwitchKbps=null,e.lastStallTime=null,e.lastPauseTime=null,e.videoSessionId="",e.videoVisibleTime=null,e.logSessionStartOnNextPlay=!1;var t=w(w({},e.playbackPerformance.segments[e.playbackPerformance.segments.length-1]),{},{lastStartPlayTime:null,playbackStartDate:null,switchBitrateKbps:-1,watchedDurationMs:0});e.playbackPerformance.detailedErrors="",e.playbackPerformance.downloadedKiloBytes=0,e.playbackPerformance.errorCode=0,e.playbackPerformance.errorName="",e.playbackPerformance.errorReason="",e.playbackPerformance.hasFatalError=!1,e.playbackPerformance.numberOfStalls=0,e.playbackPerformance.numberOfSeeks=0,e.playbackPerformance.playbackStartTimestamp=null,e.playbackPerformance.totalStallDurationMs=0,e.playbackPerformance.segments=[t]}),k(P(e),"setLastSegmentStartPlayTime",function(){var t=e.playbackPerformance.segments,r=t&&t[t.length-1];r&&null===r.lastStartPlayTime&&(r.lastStartPlayTime=e.getCurrentVideoTime())}),k(P(e),"setLastSegmentPlaybackStartDate",function(){var t=e.playbackPerformance.segments,r=t&&t[t.length-1];r&&null===r.playbackStartDate&&(r.playbackStartDate=Date.now())}),k(P(e),"setPlaybackStartTime",function(){e.hasPlaybackStarted||(e.playbackPerformance.playbackStartTimestamp=Date.now(),e.hasPlaybackStarted=!0)}),k(P(e),"setVideoPlayerRef",function(t){var r=e.props.setVideoRef;if(t&&(r&&r(t),e.videoPlayerRef=t,e.videoPlayerRef.video)){var a=e.videoPlayerRef.video;a.addEventListener("loadedmetadata",e.handleLoadedMetadata),a.addEventListener("loadeddata",e.handleLoadedData),a.addEventListener("pause",e.handleVideoPause),a.readyState>=3&&(e.setState({canPlayVideo:!0}),e.playbackPerformance.canPlayTime=new Date)}}),k(P(e),"updateStallDuration",function(){null!==e.lastStallTime&&(e.playbackPerformance.totalStallDurationMs+=new Date-e.lastStallTime,e.lastStallTime=null)}),k(P(e),"updatePauseDuration",function(){if(null!==e.lastPauseTime){var t=P(e).lastPauseTime;e.playbackPerformance.totalPauseDurationMs+=new Date-t,e.lastPauseTime=null}}),k(P(e),"updateWatchDurationForCurrentSegment",function(){var t=e.playbackPerformance.segments,r=t&&t[t.length-1],a=r?r.lastStartPlayTime:null,n=e.getCurrentVideoTime();if(r&&null!==a&&"number"==typeof n&&"number"==typeof a){var o=n-a;o>0&&(r.watchedDurationMs+=o,r.lastStartPlayTime=null)}}),k(P(e),"logPlaybackPerformance",function(t,r){var a=e.props,n=a.contextLogData,o=void 0===n?{}:n,i=a.userId,l=a.isAutoPlay,s=a.logContextEvent,c=a.preload,u=a.webBrowser,f=a.webBrowserVersion,y=o.is_closeup_video,v=void 0!==y&&y,b=e.playbackPerformance,h=b.canPlayTime,P=b.detailedErrors,g=b.downloadedKiloBytes,S=b.errorCode,k=b.errorName,T=b.errorReason,E=b.hasFatalError,D=b.playbackStartTimestamp,O=b.totalPauseDurationMs,R=b.totalStallDurationMs,C=b.segments,_=b.srcString,j=b.loadStartTime,L=b.numberOfStalls,V=b.numberOfSeeks,A=e.videoPlayerRef&&e.videoPlayerRef.video,M=t===p.DR,I=M&&!e.hasVideoSessionStarted,x=!M&&!e.hasVideoSessionEnded&&e.hasVideoSessionStarted;if(e.hls&&A&&(I||x)){var F,H=-1;h&&j&&(H=h>j?h-j:0);var N=-1;h&&e.videoVisibleTime&&(N=h>e.videoVisibleTime?h-e.videoVisibleTime:0),M&&(e.videoSessionId=(0,p.Y7)(i),e.playerId=e.playerId||(0,p.EB)());var B={autoplaying:l,averageVideoKbps:-1,detailedErrors:P,downloadedKiloBytes:g,isCellular:!1,errorCode:S,errorName:k,errorReason:T,fatalError:E,nativeVideoDurationMs:A.duration*p.gJ||-1,numberOfStalls:L,numberOfSeeks:V,overallPausedDurationMs:O,overallBufferDurationMs:R,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:e.videoSessionId,playbackStartTimestamp:D||-1,segments:[],sessionMark:t,screenPixelScale:null!==(F=window)&&void 0!==F&&F.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:A.clientWidth,startupPlayerHeight:A.clientHeight,startupTimeMs:H,startupLatencyMs:N,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:A.videoWidth,startupVariantHeight:A.videoHeight,videoUrl:_,wasVideoPreloaded:"auto"===c};if(!M&&C.length){var W=e.hls.levels,K=C[0];e.updateWatchDurationForCurrentSegment(),e.updateStallDuration();var Z=C.reduce(function(e,t){return t&&"number"==typeof t.level&&W&&W.length>0?e+(W[t.level]||{}).bitrate*(t.watchedDurationMs||0)/p.gJ:e},0),U=C.reduce(function(e,t){return e+(t.watchedDurationMs||0)},0),z=null,G=0,$=0;do G+=C[$].watchedDurationMs,z=z||C[$].level,$+=1;while($<C.length&&C[$].level===z);B.startupVariantKbps=K.indicatedKbps,B.startupVariantWatchedDurationMs=G,B.startupVariantWidth=K.sourceWidth,B.startupVariantHeight=K.sourceHeight,B.startupPlayerWidth=K.viewportWidth,B.startupPlayerHeight=K.viewportHeight,B.overallWatchedDurationMs=U,U>0?(B.averageVideoKbps=Z/(U/p.gJ),B.rebufferRate=e.playbackPerformance.totalStallDurationMs/U):0===U&&(B.averageVideoKbps=-1,B.rebufferRate=-1,B.errorName="invalid_watch_duration"),B.segments=C}else B.errorName="invalid_watch_duration";(0,d.ZP)(B,!0,v,w({playbackState:e.state.playbackState},r));var q=o.clientTrackingParams,J=o.component,Y=o.durationNs,Q=o.element,X=o.objectId,ee=o.pairId,et=o.viewData,er=o.view,ea=o.viewParameter;s({aux_data:w(w({},function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(o,m)),{},{is_closeup_video:v,playback_session_id:e.videoSessionId,web_browser:u,web_browser_version:f}),clientTrackingParams:q,component:J,duration_ns:Y,element:Q,event_data:{videoPerformanceData:B},event_type:3606,object_id_str:X,pair_id:ee,view_data:et,view_parameter:ea,view_type:er}),M?(e.hasVideoSessionStarted=!0,e.hasVideoSessionEnded=!1):e.resetPlaybackMetrics(),(0,d.tE)(M?"sessionStart":"sessionEnd",!0,v,w({playbackState:e.state.playbackState},r))}}),e}return r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.contextLogData,r=e.playing,a=(void 0===t?{}:t).is_closeup_video,n=void 0!==a&&a;this.playbackPerformance.videoCreatedTime=new Date,this.initializeHls(),(0,d.tE)("videoMounted",!0,n),r&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(p.DR,{initiator:"mount"}))}},{key:"componentDidUpdate",value:function(e){var t,r,a,n=this.props,o=n.loop,i=n.playing,l=n.src,s=n.visible,c=n.appInFocus,u=n.seekTime,d=n.captionsEnabled,f=null===(r=this.videoPlayerRef)||void 0===r?void 0:null===(a=r.video)||void 0===a?void 0:a.textTracks[0];f&&(d?f.mode="showing":f.mode="disabled",f.addEventListener("cuechange",function(){var e=f.activeCues&&f.activeCues.length>0&&f.activeCues[0];e&&e.line&&(e.line=-6,e.size=88)})),u&&u!==e.seekTime&&this.setState({videoStartTime:u}),t=e.src,(E(t)!==E(l)||(Array.isArray(l)?t.length!==l.length||l.some(function(e,r){return!Array.isArray(t)||e.type!==t[r].type||e.src!==t[r].src}):l!==t))&&this.initializeHls(),e.appInFocus&&!c&&(this.logPlaybackPerformance(p.$f,{initiator:"update",loop:o}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===s&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(p.$f,{initiator:"update",loop:o})),!1===e.visible&&!0===s&&(this.videoVisibleTime=this.videoVisibleTime||new Date,i?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(p.DR,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),i&&c&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(p.DR,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)}},{key:"componentWillUnmount",value:function(){var e=this.props.loop;this.updatePauseDuration(),this.logPlaybackPerformance(p.$f,{initiator:"unmount",loop:e}),this.destroyHls()}},{key:"render",value:function(){var e=this.props,t=e.aspectRatio,r=e.backgroundColor,a=e.captions,n=e.controls,i=e.loop,s=e.loopOverride,c=e.objectFit,u=e.onDurationChange,d=e.onFullscreenChange,p=e.onLoadedChange,f=e.onControlsPlay,m=e.onPlayheadDown,b=e.onPlayheadUp,h=e.onSeek,P=e.onVolumeChange,g=e.playbackRate,S=e.playing,w=e.playsInline,k=e.poster,T=e.preload,E=e.src,O=e.volume,R=e.webBrowser,C=e.webBrowserVersion,_=this.state,j=_.canPlayVideo,L=_.isManifestParsed,V=_.videoStartTime,A=D(E);return(0,v.jsxs)(o.xu,{children:[(0,v.jsx)(l.Z,{unsafeCSS:y.P}),(0,v.jsx)(o.nk,{ref:this.setVideoPlayerRef,aspectRatio:t,backgroundColor:r,captions:a,controls:n,loop:void 0===s?i:s,objectFit:c,onControlsPause:this.handleUserPause,onControlsPlay:f,onDurationChange:u,onEnded:this.handleEnded,onFullscreenChange:d,onLoadedChange:p,onLoadStart:this.handleLoadStart,onPlay:function(){},onPlayError:function(){},onPlayheadDown:m,onPlayheadUp:b,onPlaying:this.handlePlaying,onReady:this.handleCanPlayVideo,onSeek:h,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:P,onWaiting:this.handleStalled,playbackRate:g,playing:L&&j&&S,playsInline:w,poster:k,preload:T,src:A,startTime:V,volume:O,webBrowser:R,webBrowserVersion:C})]})}}],b(s.prototype,r),a&&b(s,a),Object.defineProperty(s,"prototype",{writable:!1}),s}(a.PureComponent);t.Z=(0,a.memo)(function(e){var t=(0,c.B)(),r=t.country,a=t.isAuthenticated,n=t.isBot,o=t.isSocialBot,l=t.unauthId,p=t.userAgent,y=(0,i.Z)(),m=(0,u.Z)(),b=p.browserName,h=p.browserVersion,P=p.isMobile,g=e.contextLogData,S=void 0===g?{}:g,k=S.is_closeup_video,T=S.view,E=S.viewParameter,D=(0,s.F)().checkExperiment,R=(0,f.I)().appUI,C=D("web_video_fail_to_start_fix").anyEnabled?R.appInFocus:e.appInFocus;return(0,d.r$)({browserName:b,browserVersion:h,country:r,isAuthenticated:a,isBot:n,is_closeup_video:void 0!==k&&k,isMobile:P,isSocialBot:o,view:T,viewParameter:E}),(0,v.jsx)(O,w(w({},e),{},{appInFocus:C,logContextEvent:y,userId:m.id||l,webBrowser:b,webBrowserVersion:h}))})},813779:function(e,t,r){r.d(t,{ZP:function(){return v},r$:function(){return f},tE:function(){return y}});var a=r(371626),n=r(115557),o=r(953565);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){var a,n;a=t,n=r[t],(a=function(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==i(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}(a))in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var u=["isCellular","videoUrl","sessionMark"],d={},p="",f=function(e){var t=e.browserName,r=e.browserVersion,n=e.country,o=e.isAuthenticated,i=e.isBot,l=e.isMobile,s=e.isSocialBot,c=e.view,u=e.viewParameter;p=s&&"socialBot"||i&&"bot"||"nonbot";var f=(0,a.Z)(n);d={browserName:t,browserVersion:(null==r?void 0:r.split(".")[0])||"0",isAuthenticated:o,isMobile:l,region:f,view:void 0===c?"unknown":c,viewParameter:void 0===u?"unknown":u}};function y(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=c(c({},a),d),i="web.video.".concat(t?"hls":"nonHls",".").concat(p,".").concat(r?"closeup":"nonCloseup",".").concat(e);"nonbot"===p&&(0,o.nP)(i,{sampleRate:1,tags:n})}function v(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r?"closeup":"nonCloseup",s=t?"hls":"nonHls",f=e.sessionMark===n.DR?"sessionStart":"sessionEnd",y=c(c({},a),d);if("nonbot"===p&&(Object.entries(e).forEach(function(t){var r=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o,i,l=[],s=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(a=o.call(r)).done)&&(l.push(a.value),l.length!==t);s=!0);}catch(e){c=!0,n=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return l}}(t,2)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=r[0],n=r[1],d="web.video.".concat(s,".").concat(p,".").concat(i,".").concat(f,".").concat(a),v=parseInt(n,10),m="number"==typeof v?v:-1;if(!u.includes(a)){if(a.includes("fatalError")&&!0===n){var b=e.errorCode,h=e.errorName,P=e.errorReason;(0,o.nP)(d,{sampleRate:1,tags:c({errorCode:b,errorName:h,errorReason:P},y)})}else if(a.includes("Width")||a.includes("Height")){var g=m<0?"negative":0===m?"zero":m<200?"xs":m<400?"s":m<600?"m":m<800?"l":m<1e3?"xl":m<1200?"xxl":"over1200";(0,o.nP)(d,{sampleRate:1,tags:c({dimensionBucket:g},y)})}else if("numberOfStalls"===a){var S=n;m>1e3?S="over1000":m>10?S="over10":m<0&&(S="negative"),(0,o.nP)(d,{sampleRate:1,tags:c({numberOfStalls:S},y)})}else"screenPixelScale"===a?(0,o.nP)(d,{sampleRate:1,tags:c({screenPixelScale:n||-1},y)}):m>=0?(0===m&&(0,o.nP)("".concat(d,".zero"),{sampleRate:1,tags:y}),(0,o.LY)(d,m,{sampleRate:1})):m<0&&(0,o.nP)("".concat(d,".negative"),{sampleRate:1,tags:y})}}),e.sessionMark!==n.DR)){var v=e.rebufferRate,m=e.screenPixelScale,b=e.startupLatencyMs,h=e.startupVariantWidth,P=e.startupPlayerWidth,g="web.video.".concat(s,".").concat(p,".").concat(i,".").concat(f);"number"==typeof h&&"number"==typeof P&&"number"==typeof m&&(0,o.nP)("".concat(g,".upscaled.").concat(1.5*h>m*P?"good":"bad"),{sampleRate:1,tags:y}),"number"==typeof b&&(0,o.nP)("".concat(g,".startupLatency.").concat(b<500?"good":"bad"),{sampleRate:1,tags:y}),"number"==typeof v&&(0,o.nP)("".concat(g,".rebufferRate.").concat(v<.01?"good":"bad"),{sampleRate:1,tags:y})}}},734950:function(e,t,r){r.d(t,{P:function(){return k},Z:function(){return E}});var a=r(672652),n=r(293041),o=r(684404),i=r(86785),l=r(140017),s=r(406893),c=r(340523),u=r(5859),d=r(554786),p=r(369708),f=r(819267);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){S(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,w(a.key),a)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,r){return(t=w(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==y(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===y(t)?t:String(t)}var k="\n  video::cue {\n    color: white;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Helvetica, 'ヒラギノ角ゴ Pro W3', 'メイリオ', Meiryo, 'ＭＳ Ｐゴシック', Arial, sans-serif;\n    font-weight: 450;\n    font-size: 18px;\n  }\n",T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(c,e);var t,r,a,l=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=g(c);if(t){var a=g(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return function(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return P(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return S(P(e=l.call.apply(l,[this].concat(r))),"state",{videoStartTime:0,started:!1}),S(P(e),"setVideoPlayerRef",function(t){var r=e.props,a=r.setVideoRef,n=r.handlePlay,o=r.autoplay;e.videoPlayerRef=t,t&&a&&a(t.video),e.videoPlayerRef&&e.videoPlayerRef.video&&n&&(void 0===o||o)&&e.videoPlayerRef.video.addEventListener("canplay",function(){n({userTriggeredPlay:!1})})}),S(P(e),"hls",null),S(P(e),"initializeHls",function(){e.destroyHls();var t=e.props.src,r=new n.ZP;n.ZP.isSupported()&&!(0,i.G6)(e.props.requestContext.userAgent.browserName)&&(r.loadSource(t),e.videoPlayerRef&&r.attachMedia(e.videoPlayerRef.video)),e.hls=r}),S(P(e),"destroyHls",function(){var t=P(e).hls;t&&t.destroy()}),S(P(e),"onPlay",function(t){var r=t.event,a=e.props.handlePlay;r.stopPropagation(),a&&a({userTriggeredPlay:!0})}),S(P(e),"onPause",function(t){var r=t.event,a=e.props.handlePause;r.stopPropagation(),a&&a()}),S(P(e),"handleVolumeChange",function(t){var r=t.event,a=t.volume,n=e.props.onVolumeChange;r.stopPropagation(),n&&n({volume:a})}),S(P(e),"handleOnReady",function(t){e.props.onReady&&e.props.onReady(t)}),S(P(e),"handleEnded",function(){var t=e.props.onEnded;t&&t()}),S(P(e),"handlePlaying",function(){var t=e.props,r=t.clearSeekTime,a=t.setVideoPlayed;r&&r(),!e.state.started&&(e.setState({started:!0}),a&&a())}),e}return r=[{key:"componentDidMount",value:function(){this.initializeHls()}},{key:"componentWillUnmount",value:function(){this.destroyHls()}},{key:"componentDidUpdate",value:function(e){var t,r,a=this,o=this.props,i=o.activeStreamItemIndex,l=o.playing,s=o.src,c=o.seekTime,u=o.captionsEnabled,d=o.isDesktop,p=o.isTablet,f=o.requestContext,y=o.isVideoPin,v=f.isAuthenticated;c&&c!==e.seekTime&&this.setState({videoStartTime:c});var m=null===(t=this.videoPlayerRef)||void 0===t?void 0:null===(r=t.video)||void 0===r?void 0:r.textTracks[0];m&&(u?m.mode="showing":m.mode="disabled",m.addEventListener("cuechange",function(){var e=m.activeCues&&m.activeCues.length>0&&m.activeCues[0];if(e&&e.line&&e.size){if(d)e.line=-6,e.size=88;else{if(e.size=70,y){e.line=-5;return}v?e.line=-8:(e.line=-10,p&&(e.line=-15))}}})),i!==e.activeStreamItemIndex&&this.videoPlayerRef&&this.videoPlayerRef.video&&(this.videoPlayerRef.video.currentTime=0),e.src!==s&&(this.initializeHls(),this.hls&&this.hls.on(n.ZP.Events.MANIFEST_PARSED,function(){void 0!==l&&l&&a.videoPlayerRef&&a.videoPlayerRef.play()}))}},{key:"render",value:function(){var e=this.props,t=e.aspectRatio,r=e.controls,a=e.loop,n=e.poster,i=e.src,l=e.onTimeChange,c=e.playing,u=e.volume,d=e.captions,p=e.isInCaptionsExperiment;return(0,f.jsxs)(o.xu,{width:"100%",children:[(0,f.jsx)(s.Z,{unsafeCSS:k}),(0,f.jsx)(o.nk,{ref:this.setVideoPlayerRef,aspectRatio:t,autoplay:c,captions:d,controls:r,crossOrigin:p?"anonymous":void 0,loop:void 0!==a&&a,onControlsPause:this.onPause,onControlsPlay:this.onPlay,onEnded:this.handleEnded,onPlay:function(){},onPlayError:function(){},onPlaying:this.handlePlaying,onReady:this.handleOnReady,onTimeChange:l,onVolumeChange:this.handleVolumeChange,playing:c,playsInline:!0,poster:n,src:i,startTime:this.state.videoStartTime||void 0,volume:u})]})}}],b(c.prototype,r),a&&b(c,a),Object.defineProperty(c,"prototype",{writable:!1}),c}(a.PureComponent);function E(e){var t=e.clearSeekTime,r=e.pinId,a=void 0===r?"":r,n=e.seekTime,o=(0,p.rG)().setVideoPlayed,i=(0,l.ZP)(),s=(0,u.B)(),y=(0,d.HG)(),v=(0,d.Wb)(),b=(0,(0,c.F)().checkExperiment)("unauth_mweb_video_pin_captions",{dangerouslySkipActivation:!0}).anyEnabled;return(0,f.jsx)(T,m(m({},e),{},{clearSeekTime:function(){t&&t(a)},i18n:i,isDesktop:y,isInCaptionsExperiment:b,isTablet:v,requestContext:s,seekTime:n,setVideoPlayed:function(){a&&o(a)}}))}},181056:function(e,t,r){r.d(t,{Ul:function(){return o},VS:function(){return a},hy:function(){return i},iM:function(){return n},j4:function(){return l}});var a=2,n=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1],o={backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, .4), rgba(0, 0, 0, 0))",pointerEvents:"none",bottom:0},i=128,l=function(e){return e&&document.querySelector('video[poster="'.concat(e,'"]'))||null}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/65923-bbafa8f17146b18e.js.map